(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/cart/main"],{"4da4":function(t,e,i){"use strict";var n=i("e491"),s=i.n(n);s.a},"5a14":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container",attrs:{eventid:"7db8257e-8"},on:{click:t.showevent,touchstart:t.changeshowdelete}},[t._l(t.cartlist,function(e,n){return i("div",{key:n,staticClass:"cart"},[t.discount[n]?i("div",{staticClass:"title"},[i("image",{attrs:{src:"../../static/cart/gift.png"}}),t._v("每满"+t._s(t.discount[n].condition)+"元，立减"+t._s(t.discount[n].subtraction)+"元，"),i("span",{directives:[{name:"show",rawName:"v-show",value:!e.reduce,expression:"!v.reduce"}]},[t._v("还差"+t._s(t.discount[n].condition-e.amount)+"元")]),i("span",{directives:[{name:"show",rawName:"v-show",value:e.reduce,expression:"v.reduce"}]},[t._v("已优惠"+t._s(e.reduce)+"元")])]):t._e(),t._l(e.list,function(e,s){return i("div",{key:s},[0==s?i("line",{attrs:{mpcomid:"7db8257e-0-"+n+"-"+s}}):t._e(),i("div",{staticClass:"onerow",style:{right:e.slide?t.padB:""},attrs:{eventid:"7db8257e-6-"+n+"-"+s},on:{touchstart:function(i){t.touchStart(e,i)},touchmove:function(i){t.touchMove(e,i)},touchend:t.touchfinish}},[i("div",{staticClass:"input",attrs:{eventid:"7db8257e-0-"+n+"-"+s},on:{click:function(t){e.checked=e.checked?0:1}}},[i("image",{directives:[{name:"show",rawName:"v-show",value:e.checked,expression:"vv.checked"}],attrs:{src:"../../static/cart/tick.png"}}),i("image",{directives:[{name:"show",rawName:"v-show",value:!e.checked,expression:"!vv.checked"}],attrs:{src:"../../static/cart/untick.png"}})]),i("image",{staticClass:"photo",attrs:{src:e.img,eventid:"7db8257e-1-"+n+"-"+s},on:{click:function(i){t.getdetail(e)}}}),i("div",{staticClass:"detail"},[i("span",{attrs:{eventid:"7db8257e-2-"+n+"-"+s},on:{click:function(i){t.getdetail(e)}}},[t._v(t._s(e.title))]),i("div",{staticClass:"bottom"},[i("div",{staticClass:"price"},[t._v("￥"+t._s(e.price))]),i("count",{attrs:{count:e.count,eventid:"7db8257e-3-"+n+"-"+s,mpcomid:"7db8257e-1-"+n+"-"+s},model:{value:e.count,callback:function(t){e.count=t},expression:"vv.count"}})],1)]),i("div",{staticClass:"remove"},[i("div",{attrs:{eventid:"7db8257e-4-"+n+"-"+s},on:{click:function(i){t.collectdelete(e)}}},[t._v("移入"),i("br"),t._v("收藏")],1),i("div",{attrs:{eventid:"7db8257e-5-"+n+"-"+s},on:{click:function(i){t.justdelete(e)}}},[t._v("删除")])])]),i("line",{attrs:{mpcomid:"7db8257e-2-"+n+"-"+s}})],1)})],2)}),i("div",{staticClass:"bottom"},[i("div",{staticClass:"left"},[i("div",{staticClass:"input"},[i("div",{staticClass:"select",attrs:{eventid:"7db8257e-7"},on:{click:t.selectall}},[i("image",{directives:[{name:"show",rawName:"v-show",value:t.allselect,expression:"allselect"}],attrs:{src:"../../static/cart/tick.png"}}),i("image",{directives:[{name:"show",rawName:"v-show",value:!t.allselect,expression:"!allselect"}],attrs:{src:"../../static/cart/untick.png"}}),i("span",[t._v("全选")])]),i("div",[i("div",[t._v("合计:￥"+t._s(t.calculateRes.amount-t.calculateRes.reduce))]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.calculateRes.reduce,expression:"calculateRes.reduce"}]},[t._v("总额:￥"+t._s(t.calculateRes.amount)+" 立减:￥"+t._s(t.calculateRes.reduce))])])])]),i("div",{staticClass:"right"},[t._v("去结算("+t._s(t.calculateRes.count)+")")])])],2)},s=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return s})},"7cd1":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=u(i("8521")),s=u(i("0a69")),c=i("bd71"),o=u(i("e5fb")),a=i("2f62");function u(t){return t&&t.__esModule?t:{default:t}}function r(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){l(t,e,i[e])})}return t}function l(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var d={data:function(){return{discount:{"活动1":{condition:100,subtraction:10},"活动2":{condition:120,subtraction:10}},shoppingList:[],calculateRes:{},allselect:!1,time:0,touchDot:0,interval:0,Move:!1,item:0,showdelete:!1,ChangeByGet:!1}},computed:{padB:function(){return t.upx2px(300)+"px"},cartlist:function(){var t={},e=0,i=0,n=0;for(var s in this.shoppingList.forEach(function(e){t[e.discount]?t[e.discount]["list"].push(e):(t[e.discount]={list:[]},t[e.discount]["list"].push(e))}),t){var c=0,o=0;t[s]["list"].forEach(function(t){t.checked&&(c+=1e4*t.price*t.count,n+=t.count)}),c/=1e4,t[s]["amount"]=c,"无"==s||c>=this.discount[s].condition&&(o=this.discount[s].subtraction*Math.floor(c/this.discount[s].condition)),t[s]["reduce"]=o}for(var a in t)e+=t[a].amount,i+=t[a].reduce;return this.calculateRes={reduce:i,amount:e,count:n},this.shoppingList.some(function(t){return 0==t.checked})||(this.allselect=!0),this.shoppingList.some(function(t){return 1==t.checked})||(this.allselect=!1),t}},methods:r({},(0,a.mapMutations)(["judgeLogin"]),(0,a.mapActions)(["isbntobookdetail","getsearchlist"]),{getdetail:function(t){t.slide||this.isbntobookdetail(t.isbn13)},getcartlist:function(){var t=this;o.default.get("userInfo")?c.fly.get(c.urlAuth+"/getcartlist").then(function(e){console.log(4747,e);var i=[],n=e.data.data.data,s=e.data.data.list;n.forEach(function(t,e){var n=JSON.parse(t),c={discount:"无"};c.img=n.msgMap.src,c.name=n.msgMap.name,c.price=parseFloat(n.msgMap.price.replace("￥","")),c.bookId=s[e].Isbn,c.checked=s[e].Checked,c.count=s[e].Count,i.push(c)}),t.ChangeByGet=!0,t.shoppingList=i,console.log(444,t.shoppingList)}).catch(function(t){console.log("获取购物清单失败",t)}):this.judgeLogin()},justdelete:function(t){var e=this,i=t.bookId,n=0,s=t.discount;this.shoppingList.forEach(function(t,s){t.bookId===i&&(n=s,e.shoppingList.splice(s,1))}),this.shoppingList.slice(0,n).some(function(t){return t.discount===s})||this.shoppingList.forEach(function(t,i){t.discount===s&&(i<n?(e.shoppingList.splice(n,0,t),e.shoppingList.splice(i,1)):(e.shoppingList.splice(i,1),e.shoppingList.splice(n,0,t)))})},collectdelete:function(t){this.justdelete(t)},selectall:function(){var t=this;this.shoppingList.forEach(function(e){e.checked=t.allselect?0:1})},showevent:function(t){},touchStart:function(t,e){var i=this;this.touchDot=e.touches[0],this.item=t,this.interval=setInterval(function(){i.time++},100)},touchMove:function(t,e){this.Move=!0},touchfinish:function(){clearInterval(this.interval),this.time=0,this.Move=!1},change:function(t){var e=this;this.time>3&&!this.Move&&(t.slide=!0,setTimeout(function(){e.showdelete=!0}),this.touchfinish())},changeshowdelete:function(){this.showdelete&&(this.shoppingList.forEach(function(t){t.slide=!1}),this.showdelete=!1)}}),components:{line:n.default,count:s.default},created:function(){},mounted:function(){},onShow:function(){this.ChangeByGet=!1,this.getcartlist()},watch:{time:function(){this.change(this.item)},shoppingList:{handler:function(){if(this.ChangeByGet)this.ChangeByGet=!1;else{var t={},e=[];this.shoppingList.forEach(function(t){var i={};i["isbn"]=t["bookId"],i["count"]=t["count"],i["checked"]=t["checked"],e.push(i)}),t["list"]=JSON.stringify(e),console.log("改正的obj===>",t),c.fly.post(c.urlAuth+"/changecart",t).then(function(t){}).catch(function(t){console.log("报错",t)})}},deep:!0}}};e.default=d}).call(this,i("543d")["default"])},a530:function(t,e,i){"use strict";i.r(e);var n=i("5a14"),s=i("e3e1");for(var c in s)"default"!==c&&function(t){i.d(e,t,function(){return s[t]})}(c);i("4da4");var o=i("2877"),a=Object(o["a"])(s["default"],n["a"],n["b"],!1,null,"9a7899ae",null);e["default"]=a.exports},afe3:function(t,e,i){"use strict";i("6d72");var n=c(i("b0ce")),s=c(i("a530"));function c(t){return t&&t.__esModule?t:{default:t}}Page((0,n.default)(s.default))},e3e1:function(t,e,i){"use strict";i.r(e);var n=i("7cd1"),s=i.n(n);for(var c in n)"default"!==c&&function(t){i.d(e,t,function(){return n[t]})}(c);e["default"]=s.a},e491:function(t,e,i){}},[["afe3","common/runtime","common/vendor"]]]);